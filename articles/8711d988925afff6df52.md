---
title: "新卒一年目の自分がよく使うgitコマンド"
emoji: "📚"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["git"]
published: true
---

🚨🚨**図をもっとわかりやすく修正予定**🚨🚨

[Learn Git Branching 日本語版](https://learngitbranching.js.org/?locale=ja)

HEAD・・・通常作業しているブランチを指す、コミットを直接指すこともできる
\*・・・HEADのこと、ブランチを指す際に省略形として、"ブランチ*"と書かれる
main・・・ローカルブランチ、いつも作業してるところ
👉厳密にはHEADが指してるところが作業するところ
origin/main・・・追跡ブランチ
(remote)main・・・GitHubにあるmainブランチ

# ローカル
```sh
$ git init 
# .gitフォルダを作成し、今いるディレクトリをリポジトリと認識する（リポジトリの新規作成）
# または既存のリポジトリを初期化する

$ git status
# リポジトリの状態を表示
# 今いるローカルブランチ、追跡ブランチと新しく追加されたファイル、変更したファイル、ステージングしたファイルがわかる

$ git status -s
# 短縮したstatusがみれる
# M_ == ステージングしたファイル
# _M == 変更したファイル
# ?? == 新しく追加されたファイル

$ git log
# コミット履歴が見れる

$ git add ファイル指定
# ステージングする（ファイルをコミットの対象にする）

$ git commit -m "〇〇"
# 変更をリポジトリに記録する
```
上記流れを宇宙飛行士に例えてみた
![](https://storage.googleapis.com/zenn-user-upload/5c5bf3898c67ee0699783042.png)

```sh
$ git branch 〇〇
# ブランチを作成
# オプションで削除、一覧表示などもできる
```
前提
![](https://storage.googleapis.com/zenn-user-upload/2250d965ec00938e18d09398.png)
developmentブランチを作成
![](https://storage.googleapis.com/zenn-user-upload/6bbbd5fa9f020dbd7991516c.png)

```sh
$ git checkout 〇〇
# 異なるブランチに切り替える
```
developmentブランチに切り替え
![](https://storage.googleapis.com/zenn-user-upload/2e0fbf1807fe3c8a0a176384.png)
developmentでコミット
![](https://storage.googleapis.com/zenn-user-upload/6fd198004d117e1e0181a445.png)
mainにブランチを切り替えてコミット
![](https://storage.googleapis.com/zenn-user-upload/ce1470180e4042892cc0d1cd.png)

```sh
$ git merge 〇〇
# 他のブランチやコミットの内容を現在のブランチに取り込む
```
前提
![](https://storage.googleapis.com/zenn-user-upload/f1f4ac3b2ef99373c97b7c68.png)
mainブランチでdevelopmentブランチをmerge
![](https://storage.googleapis.com/zenn-user-upload/f938a3d798a62881de8a3df4.png)
developmentブランチにチェックアウトし、
![](https://storage.googleapis.com/zenn-user-upload/ef0d92785c480e84916264d1.png)
mainブランチをmerge
![](https://storage.googleapis.com/zenn-user-upload/d34381532f2e7954c2ee31fa.png)

```sh
$ git rebase 〇〇
# コミットを再適用する
```
前提
![](https://storage.googleapis.com/zenn-user-upload/f1f4ac3b2ef99373c97b7c68.png)
mainブランチでdevelopmentをリベースする
![](https://storage.googleapis.com/zenn-user-upload/805fe1a029318d7215246420.png)
developmentにチェックアウト
![](https://storage.googleapis.com/zenn-user-upload/725b3f10f36f58715d7b1952.png)
developmentブランチでmainをリベースする
![](https://storage.googleapis.com/zenn-user-upload/7ab210023ebe490c79f602a0.png)

```sh
$ git reset オプション コミット名
# 今いるブランチを特定のコミットの状態まで戻す
# オプションは3種類
# --soft・・・特定のコミットの状態まで戻し、変更をステージングに移動する
# --mixed・・・特定のコミットの状態まで戻し、変更を作業ディレクトリに移動する
# --hard・・・特定のコミットの状態まで戻し、変更をなかったことにする（変更破棄）
```
developmentブランチをC1までresetする
![](https://storage.googleapis.com/zenn-user-upload/910f7c33d25156c9769d48d6.png)

# リモート
GitHubにてリポジトリは作成済みとして考える
リモートのブランチ名とローカルのブランチ名は対になっている

```sh
$ git remote add origin 追加したいリモートリポジトリ(https://github.com/~~~~)
# リモートリポジトリのアクセス先がoriginと言う名前でローカルに設定される
# originという名前(識別子)でリモートリポジトリを指している
# originはローカルの追跡ブランチと呼ばれるもの
```
- origin/main・・・追跡ブランチの名前（この場合リモートリポジトリのmainを追跡してる）
- origin main・・・追跡ブランチが指してるリモートのブランチのこと
![](https://storage.googleapis.com/zenn-user-upload/db912541f33bedb3d233c05f.png)
mainブランチでgit remote add origin 追加したいリモートリポジトリ(https://github.com/~~~~)
![](https://storage.googleapis.com/zenn-user-upload/6e0eac13ef255818a00b5283.png)

```sh
$ git push
# ローカルブランチの変更内容(commit)をリモートブランチに送信する
```
前提
![](https://storage.googleapis.com/zenn-user-upload/8d8797921919624384bda3ca.png)
mainブランチでコミット
![](https://storage.googleapis.com/zenn-user-upload/c9ac4ebe7ae63c5267b42e6d.png)
mainブランチでpushする
![](https://storage.googleapis.com/zenn-user-upload/3f9103a5a3dedb16175bdb37.png)
リモートが更新されたから追跡ブランチも更新される
👉pushは2段階の処理をしている
    1. ローカルリポジトリの変更をリモートリポジトリへ送信
    2. 追跡ブランチを更新
![](https://storage.googleapis.com/zenn-user-upload/763f8c0f950962bb9a85aacd.png)

```sh
$ git clone
# リモートリポジトリのクローンを作成する
```
前提
![](https://storage.googleapis.com/zenn-user-upload/c5b16da131e56ba300457113.png)
作業ディレクトリでリモートリポジトリをclone
![](https://storage.googleapis.com/zenn-user-upload/461b10d916d9d5a4fc5c5f48.png)
```sh
$ git fetch
# リモートリポジトリのブランチ内容を追跡ブランチに反映させる
```
前提
![](https://storage.googleapis.com/zenn-user-upload/64180b98b24610b6afc8c6a4.png)
mainブランチでfetchを実行
![](https://storage.googleapis.com/zenn-user-upload/7445e5c093840c2dc7b26885.png)
mainブランチでorigin/mainをmerge
![](https://storage.googleapis.com/zenn-user-upload/d4183da180d4d40193c29a63.png)
```sh
$ git pull
# fetch+merge
# 上記のfetchからのmergeが一気に行える
```
前提
![](https://storage.googleapis.com/zenn-user-upload/64180b98b24610b6afc8c6a4.png)
mainブランチでfetchを実行 ＋ mainブランチでorigin/mainをmerge
![](https://storage.googleapis.com/zenn-user-upload/d4183da180d4d40193c29a63.png)


## リモートで難しくなる処理
#### commitの仕様
- mainブランチで行う
![](https://storage.googleapis.com/zenn-user-upload/fbf5d27bcb3b1049bf9dc9d0.png)
- origin/mainブランチ（追跡ブランチ）で行う
![](https://storage.googleapis.com/zenn-user-upload/c173a447ecb85066bfd51702.png)
origin/mainはリモートの更新時のみ更新される
👉普通はない
#### rebaseでコミット履歴を綺麗にする
前提
![](https://storage.googleapis.com/zenn-user-upload/37ac058f5c1703570f3e9e8a.png)
mainブランチでfetch
![](https://storage.googleapis.com/zenn-user-upload/9c9f78d87991a24679cfe413.png)
mainブランチでorigin/mainをrebase
![](https://storage.googleapis.com/zenn-user-upload/1dc67ea1b3a90219d46b9616.png)
mainブランチでpush
![](https://storage.googleapis.com/zenn-user-upload/71bfff12b5b31f3d43ab2967.png)
![](https://storage.googleapis.com/zenn-user-upload/5d365b82070b87c19a81e314.png)

上記の場合はC4、つまりローカルの記述が優先されていることになる

### コンフリクトの修正
追跡ブランチとローカルブランチのmergeを行うことで起きてしまう
![](https://storage.googleapis.com/zenn-user-upload/73d5bb8cf7ebbe90eaa0721d.png)
pullすると、fetchは成功するが、mergeがうまくいかない
![](https://storage.googleapis.com/zenn-user-upload/b24930b57dca7539deee0168.png)
ファイルは以下のようなことになっている
```sh
 <<<<<<< HEAD
 ローカルブランチでの変更
 ======= 
 
 =======
 リモートブランチでの変更（追跡ブランチをみてる）
 >>>>>>> 〇〇
```
修正し、コミットしなおす
```sh
git add,git commit -m "C5"
```
![](https://storage.googleapis.com/zenn-user-upload/0ae9969385f4dc438a8e9f38.png)
mainブランチでgit push
![](https://storage.googleapis.com/zenn-user-upload/7f1ad1e7c0e7bb9d5b528bff.png)
![](https://storage.googleapis.com/zenn-user-upload/86e8c2e00313324bd2f4c941.png)

👉今回はmergeがうまくいかない場合、rebaseでも同様のことが起きるので注意
👉こまめにpullしよう

### mergeの中止（コンフリクトの修正が間に合わない場合）
```sh
$ git merge --abort
```
![](https://storage.googleapis.com/zenn-user-upload/b24930b57dca7539deee0168.png)
--abortすると...
![](https://storage.googleapis.com/zenn-user-upload/91395fe1c0d028a31ee0739b.png)
となり、rebaseすることも選択できる
